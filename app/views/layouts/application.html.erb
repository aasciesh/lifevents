<!DOCTYPE html>
<html>
<head>
  <title>Happenly</title>
 
  <%= csrf_meta_tags %>
 
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
  <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/themes/base/jquery-ui.css" type="text/css" media="all" />
<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
 <!--[if lte IE 8]>
     <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
 <![endif]-->
  <%= stylesheet_link_tag    "application", :media => "all" %>
</head>

<body>
	<%= render 'layouts/navbar' %>
	
		<%= yield %>
	
	<div id='successDiv'></div>
	<div id='errorDiv'>
		<div id='errorContent'>
			<div>
				<i class='icon-remove-circle close-errorDiv' style='float:right; margin: 5px;' alt= 'Close'></i>
			</div>
			<div>

			</div>
		</div>
	</div>	
</body>
	<%= render 'layouts/footer' %>
	<script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>
	<%= javascript_include_tag "application" %>
	<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/jquery-ui.min.js" type="text/javascript"></script>
	 <script src="https://s3.amazonaws.com/merohub/jquery.ui.addresspicker.js"></script>
	 <script type="text/javascript" src="https://s3.amazonaws.com/merohub/jquery-ui-timepicker-addon.js"></script>
	<script type="text/javascript">
	// Homepage map height set and map center position scripts

		var docWidth = $(document).width();
		var percent = Math.round(docWidth * 0.05) ;
		var position = (percent + 380) + "px" ;
		

		$("#map").height($(document).height() - 45);
		var map = L.map('map').setView([<%=user_location.latitude%>, <%=user_location.longitude%>], 13);
		L.tileLayer('http://{s}.tile.cloudmade.com/bf1b79ed16d34e568ff0b0295e99d328/997/256/{z}/{x}/{y}.png', {
    	attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
    	maxZoom: 18
		}).addTo(map);

		$(".leaflet-control-zoom").css('margin-left', position);
		window.onresize = function() {
			$("#map").height($(document).height() - 45);
			var docWidth = $(document).width();
			var percent = Math.round(docWidth * 0.05) ;
			var position = (percent + 380) + "px" ;
			$(".leaflet-control-zoom").css('margin-left', position);
			}
		$(function() {
		$( "#event_address" ).addresspicker();
		$("#event_from_time, #event_to_time").datetimepicker();
	});
	</script>
</html>
